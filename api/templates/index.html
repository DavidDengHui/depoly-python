<!DOCTYPE html>
<html>
<head>
  <title>API</title>
  <link rel="shortcut icon" href="https://hnest.eu.org/favicon.ico">
  <script>
    // å®šä¹‰base64å­—ç¬¦é›†
    var base64chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";

    // å®šä¹‰base64ç¼–ç å‡½æ•°
    function base64encode(str) {
      // å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„
      var bytes = [];
      for (var i = 0; i < str.length; i++) {
        bytes.push(str.charCodeAt(i));
      }
      // åˆå§‹åŒ–ç»“æœå­—ç¬¦ä¸²
      var result = "";
      // éå†å­—èŠ‚æ•°ç»„ï¼Œæ¯ä¸‰ä¸ªå­—èŠ‚ä¸ºä¸€ç»„ï¼Œè¿›è¡Œç¼–ç 
      for (var i = 0; i < bytes.length; i += 3) {
        // è·å–å½“å‰ç»„çš„ä¸‰ä¸ªå­—èŠ‚
        var b1 = bytes[i];
        var b2 = bytes[i + 1] || 0;
        var b3 = bytes[i + 2] || 0;
        // å°†ä¸‰ä¸ªå­—èŠ‚æ‹¼æ¥ä¸ºä¸€ä¸ª24ä½çš„äºŒè¿›åˆ¶æ•°
        var bin = (b1 << 16) | (b2 << 8) | b3;
        // å°†24ä½çš„äºŒè¿›åˆ¶æ•°åˆ†å‰²ä¸ºå››ä¸ª6ä½çš„äºŒè¿›åˆ¶æ•°
        var c1 = (bin >> 18) & 63;
        var c2 = (bin >> 12) & 63;
        var c3 = (bin >> 6) & 63;
        var c4 = bin & 63;
        // æ ¹æ®base64å­—ç¬¦é›†ï¼Œå°†å››ä¸ª6ä½çš„äºŒè¿›åˆ¶æ•°è½¬æ¢ä¸ºå››ä¸ªå­—ç¬¦
        var r1 = base64chars.charAt(c1);
        var r2 = base64chars.charAt(c2);
        var r3 = base64chars.charAt(c3);
        var r4 = base64chars.charAt(c4);
        // å¦‚æœåŸå­—ç¬¦ä¸²é•¿åº¦ä¸æ˜¯3çš„å€æ•°ï¼Œéœ€è¦åœ¨ç»“æœå­—ç¬¦ä¸²æœ«å°¾æ·»åŠ ç­‰å·
        if (i + 1 >= bytes.length) {
          r3 = "=";
          r4 = "=";
        }
        if (i + 2 >= bytes.length) {
          r4 = "=";
        }
        // å°†å››ä¸ªå­—ç¬¦æ‹¼æ¥åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­
        result += r1 + r2 + r3 + r4;
      }
      // è¿”å›ç»“æœå­—ç¬¦ä¸²
      return result;
    }

    //å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè§£ç base64å­—ç¬¦ä¸²
    function base64decode(str) {
      //ä½¿ç”¨atob()æ–¹æ³•å°†base64å­—ç¬¦ä¸²è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°æ®
      var data = atob(str);
      //åˆ›å»ºä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œç”¨äºå­˜å‚¨è§£ç åçš„ç»“æœ
      var result = "";
      //éå†äºŒè¿›åˆ¶æ•°æ®çš„æ¯ä¸ªå­—èŠ‚
      for (var i = 0; i < data.length; i++) {
        //è·å–å½“å‰å­—èŠ‚çš„ASCIIç å€¼
        var code = data.charCodeAt(i);
        //å°†ASCIIç å€¼è½¬æ¢ä¸ºå¯¹åº”çš„å­—ç¬¦ï¼Œå¹¶æ‹¼æ¥åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­
        result += String.fromCharCode(code);
      }
      //è¿”å›ç»“æœå­—ç¬¦ä¸²
      return result;
    }

    // å®šä¹‰ç¼–ç æŒ‰é’®ç‚¹å‡»äº‹ä»¶å¤„ç†å‡½æ•°
    function encode() {
      // è·å–è¾“å…¥æ¡†ä¸­çš„å†…å®¹
      var input = document.getElementById("input").value;
      // è°ƒç”¨base64ç¼–ç å‡½æ•°ï¼Œå¾—åˆ°ç¼–ç åçš„å†…å®¹
      var output = base64encode(input);
      // å°†ç¼–ç åçš„å†…å®¹æ˜¾ç¤ºåœ¨è¾“å‡ºæ¡†ä¸­
      document.getElementById("output").value = output;
    }

    // å®šä¹‰è§£ç æŒ‰é’®ç‚¹å‡»äº‹ä»¶å¤„ç†å‡½æ•°
    function decode() {
      // è·å–è¾“å…¥æ¡†ä¸­çš„å†…å®¹
      var input = document.getElementById("input").value;
      // è°ƒç”¨base64è§£ç å‡½æ•°ï¼Œå¾—åˆ°è§£ç åçš„å†…å®¹
      var output = base64decode(input);
      // å°†è§£ç åçš„å†…å®¹æ˜¾ç¤ºåœ¨è¾“å‡ºæ¡†ä¸­
      document.getElementById("output").value = output;
    }

    function jiaohuan() {
      var k = document.getElementById("input").value;
      document.getElementById("input").value = document.getElementById("output").value;
      document.getElementById("output").value = k;
    }

    function chongzhi() {
      document.getElementById("input").value = "";
      document.getElementById("output").value = "";
    }
  </script>
  <script>
    //å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†é“¾æ¥ä¸­çš„&ç¬¦å·è¿›è¡Œurlè½¬ä¹‰
    function escapeUrl(url) {
      //ä½¿ç”¨replaceæ–¹æ³•å°†&ç¬¦å·æ›¿æ¢ä¸º%26
      return url.replace(/&/g, "%26");
    }

    //å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºç”Ÿæˆæ–°çš„é“¾æ¥å¹¶æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š
    function generateLink() {
      //è·å–è¾“å…¥æ¡†ä¸­çš„é“¾æ¥
      var inputURL = document.getElementById("inputURL").value;
      //è°ƒç”¨escapeUrlå‡½æ•°å°†é“¾æ¥è¿›è¡Œurlè½¬ä¹‰
      var escaped = escapeUrl(inputURL);
      //æ‹¼æ¥æ–°çš„é“¾æ¥
      var newLink = "https://api.hnest.eu.org/api?url=" + escaped;
      //è·å–æ˜¾ç¤ºæ¡†å…ƒç´ 
      var outputURL = document.getElementById("outputURL");
      //è®¾ç½®æ˜¾ç¤ºæ¡†çš„å†…å®¹ä¸ºæ–°çš„é“¾æ¥ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªaæ ‡ç­¾ï¼Œä½¿å…¶å¯ä»¥ç‚¹å‡»æ‰“å¼€æ–°çª—å£
      outputURL.innerHTML = "<a href='/api?url=" + escaped + "' target='_blank'>" + newLink + "</a>";
      //è·å–å¤åˆ¶æŒ‰é’®å…ƒç´ 
      var copyButton = document.getElementById("copy");
      //è®¾ç½®å¤åˆ¶æŒ‰é’®çš„å±æ€§ä¸ºå¯è§
      copyButton.style.visibility = "visible";
    }

    //å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå¤åˆ¶ç”Ÿæˆçš„é“¾æ¥
    function copyLink() {
      //è·å–æ˜¾ç¤ºæ¡†å…ƒç´ 
      var output = document.getElementById("outputURL");
      //è·å–æ˜¾ç¤ºæ¡†ä¸­çš„aæ ‡ç­¾å…ƒç´ 
      var link = output.getElementsByTagName("a")[0];
      //è·å–aæ ‡ç­¾ä¸­çš„hrefå±æ€§å€¼ï¼Œå³ç”Ÿæˆçš„é“¾æ¥
      var text = link.href;
      //åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„inputå…ƒç´ ï¼Œç”¨äºå­˜å‚¨è¦å¤åˆ¶çš„æ–‡æœ¬
      var tempInput = document.createElement("inputURL");
      //å°†inputå…ƒç´ æ·»åŠ åˆ°bodyä¸­
      document.body.appendChild(tempInput);
      //è®¾ç½®inputå…ƒç´ çš„å€¼ä¸ºè¦å¤åˆ¶çš„æ–‡æœ¬
      tempInput.value = text;
      //é€‰ä¸­inputå…ƒç´ ä¸­çš„æ–‡æœ¬
      tempInput.select();
      //æ‰§è¡Œå¤åˆ¶å‘½ä»¤
      document.execCommand("copy");
      //ä»bodyä¸­ç§»é™¤inputå…ƒç´ 
      document.body.removeChild(tempInput);
    }
  </script>
</head>
<body>
  <h1>Hello, Python!</h1>
  <h2>This is a API: 
    <a href='/doit?token=Z2hwX05VejBmZzBFSjFuVXBmSUtLU1lDZjJpN3RpdVlnZzB5VjdtRA==' title='Myself API'>https://api.hnest.eu.org/doit</a>
  </h2>
  <br>
  <h1>ç›—é“¾ç”Ÿæˆå™¨</h1>
  <p>è¯·è¾“å…¥ä¸€ä¸ªé“¾æ¥ï¼š</p>
  <input type="text" id="inputURL" placeholder="https://example.com/?a=1&b=2">
  <button onclick="generateLink()">ç›—é“¾</button>
  <!-- æ·»åŠ ä¸€ä¸ªå¤åˆ¶æŒ‰é’®ï¼Œå¹¶è®¾ç½®åˆå§‹å±æ€§ä¸ºä¸å¯è§ -->
  <button id="copy" onclick="copyLink()" style="visibility: hidden;">å¤åˆ¶</button>
  <p>ç”Ÿæˆçš„é“¾æ¥ï¼š</p>
  <div id="outputURL"></div>
  <br>
  <h1>Base64ç¼–ç å’Œè§£ç </h1>
  <p>è¯·è¾“å…¥è¦ç¼–ç æˆ–è§£ç çš„å†…å®¹ï¼š</p>
  <textarea id="input" rows="10" cols="80"></textarea>
  <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®è¿›è¡Œç¼–ç æˆ–è§£ç ï¼š</p>
  <button onclick="encode()">ç¼–ç </button>
  Â Â <button onclick="jiaohuan()">äº¤ğŸ”„æ¢</button>Â 
  Â <button onclick="chongzhi()">é‡ğŸ—‘ï¸ç½®</button>Â Â 
  <button onclick="decode()">è§£ç </button>
  <p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p>
  <textarea id="output" rows="10" cols="80" readonly></textarea>
</body>
</html>
