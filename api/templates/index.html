<!DOCTYPE html>
<html>
<head>
  <title>API</title>
  <link rel="shortcut icon" href="https://hnest.eu.org/favicon.ico">
  <script>
    // 定义base64字符集
    var base64chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";

    // 定义base64编码函数
    function base64encode(str) {
      // 将字符串转换为字节数组
      var bytes = [];
      for (var i = 0; i < str.length; i++) {
        bytes.push(str.charCodeAt(i));
      }
      // 初始化结果字符串
      var result = "";
      // 遍历字节数组，每三个字节为一组，进行编码
      for (var i = 0; i < bytes.length; i += 3) {
        // 获取当前组的三个字节
        var b1 = bytes[i];
        var b2 = bytes[i + 1] || 0;
        var b3 = bytes[i + 2] || 0;
        // 将三个字节拼接为一个24位的二进制数
        var bin = (b1 << 16) | (b2 << 8) | b3;
        // 将24位的二进制数分割为四个6位的二进制数
        var c1 = (bin >> 18) & 63;
        var c2 = (bin >> 12) & 63;
        var c3 = (bin >> 6) & 63;
        var c4 = bin & 63;
        // 根据base64字符集，将四个6位的二进制数转换为四个字符
        var r1 = base64chars.charAt(c1);
        var r2 = base64chars.charAt(c2);
        var r3 = base64chars.charAt(c3);
        var r4 = base64chars.charAt(c4);
        // 如果原字符串长度不是3的倍数，需要在结果字符串末尾添加等号
        if (i + 1 >= bytes.length) {
          r3 = "=";
          r4 = "=";
        }
        if (i + 2 >= bytes.length) {
          r4 = "=";
        }
        // 将四个字符拼接到结果字符串中
        result += r1 + r2 + r3 + r4;
      }
      // 返回结果字符串
      return result;
    }

    //定义一个函数，用于解码base64字符串
    function base64decode(str) {
      //使用atob()方法将base64字符串转换为二进制数据
      var data = atob(str);
      //创建一个空字符串，用于存储解码后的结果
      var result = "";
      //遍历二进制数据的每个字节
      for (var i = 0; i < data.length; i++) {
        //获取当前字节的ASCII码值
        var code = data.charCodeAt(i);
        //将ASCII码值转换为对应的字符，并拼接到结果字符串中
        result += String.fromCharCode(code);
      }
      //返回结果字符串
      return result;
    }

    // 定义编码按钮点击事件处理函数
    function encode() {
      // 获取输入框中的内容
      var input = document.getElementById("input").value;
      // 调用base64编码函数，得到编码后的内容
      var output = base64encode(input);
      // 将编码后的内容显示在输出框中
      document.getElementById("output").value = output;
    }

    // 定义解码按钮点击事件处理函数
    function decode() {
      // 获取输入框中的内容
      var input = document.getElementById("input").value;
      // 调用base64解码函数，得到解码后的内容
      var output = base64decode(input);
      // 将解码后的内容显示在输出框中
      document.getElementById("output").value = output;
    }

    function jiaohuan() {
      var k = document.getElementById("input").value;
      document.getElementById("input").value = document.getElementById("output").value;
      document.getElementById("output").value = k;
    }

    function chongzhi() {
      document.getElementById("input").value = "";
      document.getElementById("output").value = "";
    }
  </script>
  <script>
    //定义一个函数，用于将链接中的&符号进行url转义
    function escapeUrl(url) {
      //使用replace方法将&符号替换为%26
      return url.replace(/&/g, "%26");
    }

    //定义一个函数，用于生成新的链接并显示在页面上
    function generateLink() {
      //获取输入框中的链接
      var inputURL = document.getElementById("inputURL").value;
      //调用escapeUrl函数将链接进行url转义
      var escaped = escapeUrl(inputURL);
      //拼接新的链接
      var newLink = "https://api.hnest.eu.org/api?url=" + escaped;
      //获取显示框元素
      var outputURL = document.getElementById("outputURL");
      //设置显示框的内容为新的链接，并添加一个a标签，使其可以点击打开新窗口
      outputURL.innerHTML = "<a href='/api?url=" + escaped + "' target='_blank'>" + newLink + "</a>";
      //获取复制按钮元素
      var copyButton = document.getElementById("copy");
      //设置复制按钮的属性为可见
      copyButton.style.visibility = "visible";
    }

    //定义一个函数，用于复制生成的链接
    function copyLink() {
      //获取显示框元素
      var output = document.getElementById("outputURL");
      //获取显示框中的a标签元素
      var link = output.getElementsByTagName("a")[0];
      //获取a标签中的href属性值，即生成的链接
      var text = link.href;
      //创建一个临时的input元素，用于存储要复制的文本
      var tempInput = document.createElement("inputURL");
      //将input元素添加到body中
      document.body.appendChild(tempInput);
      //设置input元素的值为要复制的文本
      tempInput.value = text;
      //选中input元素中的文本
      tempInput.select();
      //执行复制命令
      document.execCommand("copy");
      //从body中移除input元素
      document.body.removeChild(tempInput);
    }
  </script>
</head>
<body>
  <h1>Hello, Python!</h1>
  <h2>This is a API: 
    <a href='/doit?token=Z2hwX05VejBmZzBFSjFuVXBmSUtLU1lDZjJpN3RpdVlnZzB5VjdtRA==' title='Myself API'>https://api.hnest.eu.org/doit</a>
  </h2>
  <br>
  <h1>盗链生成器</h1>
  <p>请输入一个链接：</p>
  <input type="text" id="inputURL" placeholder="https://example.com/?a=1&b=2">
  <button onclick="generateLink()">盗链</button>
  <!-- 添加一个复制按钮，并设置初始属性为不可见 -->
  <button id="copy" onclick="copyLink()" style="visibility: hidden;">复制</button>
  <p>生成的链接：</p>
  <div id="outputURL"></div>
  <br>
  <h1>Base64编码和解码</h1>
  <p>请输入要编码或解码的内容：</p>
  <textarea id="input" rows="10" cols="80"></textarea>
  <p>点击下面的按钮进行编码或解码：</p>
  <button onclick="encode()">编码</button>
    <button onclick="jiaohuan()">交🔄换</button> 
   <button onclick="chongzhi()">重🗑️置</button>  
  <button onclick="decode()">解码</button>
  <p>输出结果如下：</p>
  <textarea id="output" rows="10" cols="80" readonly></textarea>
</body>
</html>
